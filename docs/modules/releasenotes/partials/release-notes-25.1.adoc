////
Howto:
- Write this document such that it helps people to discover new features and other important changes of this release.
- Chronological order is not necessary.
- Describe necessary migration steps in the MigrationGuide document.
- Use "WARNING: {NotReleasedWarning}" on its own line to mark parts about not yet released code (also add a "(since <version>)" suffix to the chapter title)
- Use "title case" in chapter titles (https://english.stackexchange.com/questions/14/)
////
== About This Release

The latest version of this release is: {maven-version}.

You can see the {github-changelog-link} on GitHub.

Coming from an older Scout version? Check out the xref:migration:migration-guide.adoc[Migration Guide] for instructions on how to obtain the new version and upgrade existing applications.

WARNING: {NotReleasedWarning}

//The following enhancements were made after the initial {scout-version} release.
//
//==== 25.1.1
//
// The initial release of this version was *25.1.xyz*.
//
//WARNING: {NotReleasedWarning}
//
//(Section intentionally left blank for possible future release)
//
// * <<New Feature (since 25.1.xyz)>>
//
// ==== Upcoming -- No Planned Release Date
//
// The following changes were made after the latest official release build. No release date has been fixed yet.
//
// WARNING: {NotReleasedWarning}
//
// * <<New Feature (since 25.1.xyz)>>

== Demo Applications

The demo applications for this version can be found on the {scout-docs-link} branch of our docs repository on GitHub.

If you just want to play around with them without looking at the source code, you can always use the deployed versions:

* https://scout.bsi-software.com/contacts/
* https://scout.bsi-software.com/widgets/
* https://scout.bsi-software.com/jswidgets/

// ----------------------------------------------------------------------------

== New Build & Runtime Requirements

Scout 25.1 requires at least the following:

* Build and runtime of Scout 25.1 require Java 21 (Java 17 support has been dropped).
* Furthermore, the build requires
** Maven >= 3.9.9
** Node: >= 22.13.0
** Pnpm: >= 9.15.4

== Simplified UiCallback

The API to call TypeScript code from the Java client code has been simplified and streamlined. See the xref:technical-guide:user-interface/ui-callback.adoc[UI Callback technical guide] for more details.

== HybridAction: Support for Context Elements

_HybridActions_ allow you to call Java code from JavaScript in Scout Classic applications.
A hybrid action consists of an ID (identifying the corresponding action in the other layer) and an arbitrary data object (holding an action-specific payload).
Additionally, you can now also include references to other UI elements, e.g. form fields, tree nodes or table rows.
The JSON adapter layer automatically converts these so-called _context elements_ to identifiers and resolves them to the corresponding counter-part on the other side.

_HybridEvents_ have a new property `contextElements` of type _HybridActionContextElements_.
This object can hold multiple lists of context elements, each list identified by a string key.
Every list consists of one or more _HybridActionContextElement_ objects with the following properties:

* `widget`: mandatory, points to a Scout widget (e.g. a table).
It is automatically converted to an adapter ID and vice versa by the JSON layer.
* `element`: optional, points to an element owned by the widget (e.g. a table row).
Only the widget-specific model adapter knows how to serialize and deserialize this reference.
This kind of conversion is handled by a matching implementation of `(I)HybridActionContextElementConverter`.
Currently, Scout provides implementations for tree nodes, table rows and table columns.
See the documentation of these classes on how to add your own custom implementation.

Example:

.Calling a HybridAction with context elements in JavaScript
[source,javascript]
----
let data = {maxRows: 5};
// Send selected row as context element to UI server
let contextElements = scout.create(HybridActionContextElements)
  .withElement('selectedRow', this.table, this.table.selectedRow());
HybridManager.get(this.session).callActionAndWaitWithContext('myapp.FindSimilarRows', data, contextElements)
  .then(result => {
    // Result rows are sent back from the UI server as context elements
    if (result.contextElements.isEmpty()) {
      MessageBoxes.openOk(this, 'No similar rows found!');
    } else {
      let similarRows = result.contextElements.getList('similarRows').map(contextElement => contextElement.getElement(TableRow));
      this.table.selectRows(similarRows);
    }
  });
----

.Consuming and sending back context elements in the HybridAction implementation in Java
[source,java]
----
@HybridActionType(FindSimilarRowsHybridAction.TYPE)
public class FindSimilarRowsHybridAction extends AbstractHybridAction<IDoEntity> {

  protected static final String TYPE = "myapp.FindSimilarRows";

  @Override
  public void execute(IDoEntity data) {
    HybridActionContextElements resultContextElements = BEANS.get(HybridActionContextElements.class);
    try {
      // Get table and selected row sent from the UI
      ITable table = getContextElement("selectedRow").getWidget(ITable.class);
      ITableRow selectedRow = getContextElement("selectedRow").getElement(ITableRow.class);
      Long maxRows = TypeCastUtility.castValue(data.get("maxRows"), Long.class);

      List<ITableRow> similarRows = BEANS.get(SimilarRowsFinder.class).findSimilarRows(table, selectedRow, maxRows);

      // Send back similar rows as context elements
      resultContextElements.withElements("similarRows", similarRows.stream()
        .map(row -> HybridActionContextElement.of(table, row))
        .collect(Collectors.toList()));
    }
    finally { // always signal the end of the action to the UI, even in the case of an error on the server
      fireHybridActionEndEvent(resultContextElements);
    }
  }
}
----

== REST MetaResource version endpoint: IApiVersion removed, new support for build date provider

The `IApiVersion` interface which was references by `MetaResource` operation `/version` was removed.
The API version was never used (e.g. increased) and did not provide any value.
The `MetaResource` operation `/version` still provides info about application name and version.

Additionally, a new `IModuleBuildDateProvider` was introduced, which allows an application to provide its own build date which is then returned as part of the `MetaResource` endpoint `/version`.

The `MetaResource` endpoint `/version` (e.g. `https://<server-url>/api/meta/version?verbose=true`) returns:

----
{
  "_type": "suite.MetaVersionInfo",
  "applicationName": "My Application",
  "applicationVersion": "1.2.34",
  "buildDate": "2024-11-20 16:01:32.000"
}
----

== Change keystroke for search and reset button
Changed the shortcut keys for search and reset to a more common key
combination.

[cols="2,1,1"]
|===
|Function |Old keystroke |New keystroke

|Open search in a table page
|F6
|Ctrl-Shift-F

|Reset button (Reset search form)
|Ctrl-F6
|Ctrl-Shift-Z
|===

== ListBox: New Default for MultiSelect

The default for the `multiSelect` property has been changed from `false` to `true`.
If it is true, the user can select all rows at once and check or uncheck them.
Also, when creating a list box with Scout JS, the default is already true, so this makes it more consistent.

== LookupColumn

The `LookupColumn` is a multivalued lookup call column. If editable it opens a popup containing a `LookupBox` in order to select multiple values.
The column supports lookup calls and code types and has a `distinct` property to enforce that the same value is not selected in more than one row.

.The `LookupColumn` with `distinct` set to `true`
image::lookup_column_salutation.png[]

.The `LookupColumn` with a hierarchical lookup call
image::lookup_column_world.png[]

== Removed deprecated code

The following code has been marked as deprecated for removal in previous releases and was now  removed:

* (Java) `ActionUtility`  -> use `MenuUtility` instead
* (TS) `Page#pageForTableRow` -> use `TableRow#page` instead

== Use scout properties for selenium test module configuration

Configuration for selenium test setup is now done through scout properties instead of system properties.
Refer to the migration guide for more details.

